amends "package://pkg.pkl-lang.org/pkl-project-commons/pkl.impl.circleci@1.2.0#/PklCI.pkl"

local testJobs = jobs.keys.filter((it) -> it.startsWith("test"))

jobs {
  ["test-license-headers"] {
    docker {
      new {
        image = "ghcr.io/korandoru/hawkeye"
      }
    }
    steps {
      "checkout"
      new RunStep {
        command = "/bin/hawkeye check --fail-if-unknown"
      }
    }
  }
}

prb {
  jobs {
    ...testJobs
  }
}

main {
  jobs {
    ...testJobs
  }
}
